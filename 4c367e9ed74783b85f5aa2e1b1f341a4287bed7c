{
  "comments": [
    {
      "key": {
        "uuid": "c8aa9e16_0ac90207",
        "filename": "crypto/trust_token/internal.h",
        "patchSetId": 3
      },
      "lineNbr": 40,
      "author": {
        "id": 5415
      },
      "writtenOn": "2020-04-27T20:46:53Z",
      "side": 1,
      "message": "The phase \"security level\" appears three times in this sentence. :-) We should cite appendix I, which seems to describe the issue, rather than just saying a \"potential theoretical attack\".\n\nTo make sure I\u0027m understanding it right, there is a p-1 attack of O(sqrt(p/d) + sqrt(d)) which, depending on smoothness, is up to a O(p^(1/4)) attack. The p+1 attack is O(sqrt(p/d) + d) which, depending on smoothness is up to a O(p^(1/3)) attack.\n\np+1 for P-256 and P-384 appear to have a lot of factors, so I\u0027m assuming that you can get close to O(p^(1/3)), which gives O(2^83) for P-256, but P-384 is still O(2^128).\n\nP-256\u0027s p-1 has a 160-bit prime factor, which means the p+1 attack further gets you to O(2^80). P-384\u0027s p-1 has a 334-bit prime factor, which means the p+1 attack only gets you to O(2^166).\n\nIs all this correct?\n\nIf so, perhaps something like \"We use P-384 instead of our usual choice of P-256. See Appendix I for a description of attacks that may affect smaller curves. Note p-1 for P-384 has a 334-bit prime factor, which limits the O(sqrt(p/d) + sqrt(d)) attack.\"\n\nRegarding \"may\" and \"potential\" in your sentence, what exactly is the status of those attacks? The paper says the attack is \"at disposal for the adversary\", but you\u0027ve suggested out-of-band that it\u0027s not actually known. Is the issue just that we\u0027ve reduced it to something else and maybe there\u0027s a better reduction?",
      "revId": "4c367e9ed74783b85f5aa2e1b1f341a4287bed7c",
      "serverId": "66b711a4-aa9b-3dac-9062-916540830212",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2faae389_a4752672",
        "filename": "crypto/trust_token/internal.h",
        "patchSetId": 3
      },
      "lineNbr": 40,
      "author": {
        "id": 5415
      },
      "writtenOn": "2020-04-27T20:52:24Z",
      "side": 1,
      "message": "Oh wait, I\u0027m taking p to be the underlying prime of the field and their p is the order of the group, so all my numbers are wrong. One moment...",
      "parentUuid": "c8aa9e16_0ac90207",
      "revId": "4c367e9ed74783b85f5aa2e1b1f341a4287bed7c",
      "serverId": "66b711a4-aa9b-3dac-9062-916540830212",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f344ff1c_55e57c2d",
        "filename": "crypto/trust_token/internal.h",
        "patchSetId": 3
      },
      "lineNbr": 40,
      "author": {
        "id": 5415
      },
      "writtenOn": "2020-04-27T22:37:13Z",
      "side": 1,
      "message": "Okay, how about:\n\nWe use P-384 instead of our usual choice of P-256. See Appendix I which describes two attacks which may affect smaller curves. In particular, p-1 for P-256 is smooth, giving a low complexity for the p-1 attack. P-384\u0027s p-1 has a 281-bit prime factor, 3055465788140352002733946906144561090641249606160407884365391979704929268480326390471. This lower-bounds the p-1 attack at O(2^140). The p+1 attack is lower-bounded by O(p^(1/3)) or O(2^128), so we do not need to check the smoothness of p+1.\n\n(I wanted to include the prime factor itself so that we can confirm this later without factoring it.)",
      "parentUuid": "2faae389_a4752672",
      "revId": "4c367e9ed74783b85f5aa2e1b1f341a4287bed7c",
      "serverId": "66b711a4-aa9b-3dac-9062-916540830212",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d4f64e16_3c8770b5",
        "filename": "crypto/trust_token/internal.h",
        "patchSetId": 3
      },
      "lineNbr": 40,
      "author": {
        "id": 5945
      },
      "writtenOn": "2020-04-28T15:28:27Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "f344ff1c_55e57c2d",
      "revId": "4c367e9ed74783b85f5aa2e1b1f341a4287bed7c",
      "serverId": "66b711a4-aa9b-3dac-9062-916540830212",
      "unresolved": false
    }
  ]
}